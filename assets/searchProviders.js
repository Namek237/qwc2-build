function usterSearch(t,e,s,r){const a="https://webgis.uster.ch/wsgi/search.wsgi?&searchtables=&query="+encodeURIComponent(t);r.get(a).then((t=>{const e=[];let r=null,a=0,o=0;(t.data.results||[]).map((t=>{t.bbox?r&&r.items.push({id:"usterresult"+o++,text:t.displaytext,searchtable:t.searchtable,bbox:t.bbox.slice(0),x:.5*(t.bbox[0]+t.bbox[2]),y:.5*(t.bbox[1]+t.bbox[3]),crs:"EPSG:21781"}):(r={id:"ustergroup"+a++,title:t.displaytext,items:[]},e.push(r))})),s({results:e})}))}function usterResultGeometry(t,e,s){const r="https://webgis.uster.ch/wsgi/getSearchGeom.wsgi?searchtable="+encodeURIComponent(t.searchtable)+"&displaytext="+encodeURIComponent(t.text);s.get(r).then((t=>{e({geometry:t.data,crs:"EPSG:21781",hidemarker:!1})}))}function geoAdminLocationSearch(t,e,s,r){const a={};e.filterBBox&&(a.bbox=window.qwc2.CoordinatesUtils.reprojectBbox(e.filterBBox,e.mapcrs,"EPSG:2056").map((t=>Math.round(t))).join(","));const o={searchText:t,type:"locations",limit:20,sr:2056,...a,...e.cfgParams||{}};r.get("https://api3.geo.admin.ch/rest/services/api/SearchServer",{params:o}).then((t=>{const e={gg25:"Municipalities",kantone:"Cantons",district:"Districts",sn25:"Places",zipcode:"Zip Codes",address:"Address",gazetteer:"General place name directory"},r=t=>{try{return t.match(/^BOX\s*\(\s*(\d+\.?\d*)\s*(\d+\.?\d*)\s*,\s*(\d+\.?\d*)\s*(\d+\.?\d*)\s*\)$/).slice(1,5).map((t=>parseFloat(t)))}catch(t){return null}},a={};(t.data.results||[]).map((t=>{void 0===a[t.attrs.origin]&&(a[t.attrs.origin]={id:t.attrs.origin,title:e[t.attrs.origin]||t.attrs.origin,items:[]});const s=t.attrs.y,o=t.attrs.x;a[t.attrs.origin].items.push({id:t.id,text:t.attrs.label,x:s,y:o,crs:"EPSG:2056",bbox:r(t.attrs.geom_st_box2d)||[s,o,s,o]})}));const o=Object.values(a);s({results:o})}))}window.QWC2SearchProviders={geoadmin:{label:"Swisstopo",onSearch:geoAdminLocationSearch},uster:{label:"Uster",onSearch:usterSearch,getResultGeometry:usterResultGeometry}};